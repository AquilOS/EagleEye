PROJECT(Vclick3d)

FIND_PACKAGE(Qt5Network)
IF(Qt5Network_FOUND)
FIND_PACKAGE(OpenCV REQUIRED COMPONENTS core videoio highgui)
FIND_PACKAGE(CUDA REQUIRED)
set(Boost_USE_STATIC_LIBS        OFF)
set(Boost_USE_MULTITHREADED      ON)
set(Boost_USE_STATIC_RUNTIME     OFF)
ADD_DEFINITIONS(-DBOOST_ALL_NO_LIB)
FIND_PACKAGE(Boost REQUIRED QUIET COMPONENTS system)

INCLUDE_DIRECTORIES(
	${EagleLib_INCLUDE_DIRECTORIES}
	"${CMAKE_CURRENT_SOURCE_DIR}/include"
	${Qt5Network_INCLUDE_DIRS}
	${Qt5Core_INCLUDE_DIRS}
)

FILE(GLOB_RECURSE hdrs "include/*.h")
FILE(GLOB_RECURSE src "src/*.cpp")

QT5_WRAP_CPP(MOC ${src} ${hdrs})
LINK_DIRECTORIES(${LINK_DIRS})
CUDA_ADD_LIBRARY(Vclick3d SHARED ${hdrs} ${src} ${MOC})
ADD_DEPENDENCIES(Vclick3d EagleLib)


TARGET_LINK_LIBRARIES(Vclick3d 
	${Boost_LIBRARIES}
	${OpenCV_LIBS}
	Qt5::Network
        Qt5::Core
	${EagleLib_LIBRARIES} 
	EagleLib
	)

GET_PROPERTY(dirs TARGET Vclick3d PROPERTY INCLUDE_DIRECTORIES)
FOREACH(dir ${INCLUDE_DIRS})
LIST(REMOVE_ITEM dirs ${dir})
ENDFOREACH()
STRING(REGEX REPLACE ";" "+" RCC_INCLUDE_DEPENDENCIES "${dirs}" )
ADD_DEFINITIONS(-DPROJECT_INCLUDES="${RCC_INCLUDE_DEPENDENCIES}")
#ADD_DEFINITIONS(-DPROJECT_LIB_DIRS="${LINK_DIRS}")


MESSAGE(STATUS
"============== VClick3D ===============
	${hdrs}

	${src}

	${MOC}

	${Qt5Network_INCLUDE_DIRS}

	${Qt5Core_INCLUDE_DIRS}

	${EagleLib_INCLUDE_DIRECTORIES}

	${RCC_INCLUDE_DEPENDENCIES}

	${Qt5_DIR}

	${CMAKE_CXX_FLAGS}

	${CMAKE_CXX_FLAGS_DEBUG}

	${CMAKE_CXX_FLAGS_RELEASE}

	${CMAKE_C_FLAGS}
")
ELSE(Qt5Network_FOUND)
MESSAGE("Qt5Network not found, not building Vclick3d plugin")
ENDIF(Qt5Network_FOUND)
